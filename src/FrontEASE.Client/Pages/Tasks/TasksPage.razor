@inject IResourceHandler resourceHandler
@inject IUIService uiService

@attribute [Authorize]
@page "/Tasks"

<PageTitle>
    @(resourceHandler.GetResource($"{UIConstants.Base}.{UIConstants.Specific}.{UIElementConstants.Page}.{UIPageConstants.Tasks}"))
</PageTitle>


<Container Fluid Class="content-main" Padding="Padding.Is5.FromStart.Is5.FromEnd">
    <Row>
        <Column ColumnSize="ColumnSize.Is12" TextAlignment="TextAlignment.Center" Padding="Padding.Is0">
            <CascadingValue Value="PageContext">
                <TaskList />
            </CascadingValue>
        </Column>
    </Row>
</Container>


@code {
    [CascadingParameter]
    public ApplicationContext ApplicationContext { get; set; } = new();

    private TasksPageContext PageContext = null!;

    private async Task RefreshViewAsync()
    {
        await InvokeAsync(StateHasChanged);
    }

    protected override async Task OnInitializedAsync()
    {
        PageContext = new(ApplicationContext);

        uiService.RefreshRequested += RefreshViewAsync;
        await base.OnInitializedAsync();
    }
}