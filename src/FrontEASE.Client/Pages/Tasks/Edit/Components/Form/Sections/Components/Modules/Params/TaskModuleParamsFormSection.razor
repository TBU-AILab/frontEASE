@inject ITaskManipulationService taskManipulationService
@inject IResourceHandler resourceHandler

@if (TaskModuleContext.ModuleData?.Parameters?.Count > 0)
{
    <Row Padding="Padding.Is3.FromBottom" Border="Border.Is1.Rounded" Class="border-custom-light" Shadow="Shadow.Small" Margin="Margin.Is3.FromTop.Is3.FromBottom" TextOverflow="TextOverflow.Wrap">
        <Column ColumnSize="ColumnSize.IsFull" Display="Display.Flex" Class="justify-content-between align-items-center" Padding="Padding.Is2">
            <Div Display="Display.Flex" Width="Width.Is100" Class="justify-content-center">
                <Text TextWeight="TextWeight.Bold" Class="text-center">
                    @(resourceHandler.GetResource(AttributeExtensions.GetResourceFieldValue<TaskModuleDto>(nameof(TaskModuleDto.Parameters), PropertyDisplayResourceType.FIELD)))
                </Text>
            </Div>
        </Column>


        <Column ColumnSize="ColumnSize.IsFull">
            <Container Fluid>
                <Row>
                    <Container Fluid Margin="Margin.Is3.FromTop">
                        <Row Padding="Padding.Is0">

                            @foreach (var paramOption in TaskModuleContext.ModuleData.Parameters.OrderBy(x => x.Readonly))
                            {
                                var paramContext = taskManipulationService.GetParamContext(paramOption, null, TaskModuleContext.Module);
                                <Fields>
                                    @if (paramOption.Readonly != true)
                                    {
                                        <TaskModuleParamValue TaskModalContext="TaskModalContext" TaskModuleContext="TaskModuleContext" TaskModuleParamContext="@paramContext" />
                                    }
                                    else
                                    {
                                        <TaskModuleParamLabel TaskModalContext="TaskModalContext" TaskModuleParamContext="@paramContext"/>
                                    }
                                </Fields>
                            }
                        </Row>
                    </Container>
                </Row>
            </Container>
        </Column>
    </Row>
}

@code {
    [Parameter]
    public TaskModalContext TaskModalContext { get; set; } = null!;

    [Parameter]
    public TaskModuleContext TaskModuleContext { get; set; } = null!;
}