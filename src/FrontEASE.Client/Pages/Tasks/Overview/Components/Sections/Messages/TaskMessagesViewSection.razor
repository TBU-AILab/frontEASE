@inject IResourceHandler resourceHandler

<Row>

    <Container Fluid>
        <FormSectionHeader DisplayText="@(resourceHandler.GetResource(AttributeExtensions.GetCollectionResourceValue<TaskMessageDto>()))" />
    </Container>

    <Divider Class="divider-section bg-custom-light" Shadow="Shadow.Small" />

    <Column ColumnSize="ColumnSize.Is12" Padding="Padding.Is3.FromTop">
        <Row>
            @if (Task.Messages.Count > 0)
            {
                @foreach (var message in Task.Messages.OrderBy(x => x.DateCreated))
                {
                    <Column ColumnSize="ColumnSize.IsFull" Margin="Margin.Is3.FromBottom">
                        @switch (message.Role)
                        {
                            case MessageRole.SYSTEM:
                                <SystemMessageView Message="message"/>
                                break;
                            case MessageRole.USER:
                                <UserMessageView Message="message" IsFullWidth="false" />
                                break;
                            case MessageRole.AI:
                                <AssistantMessageView TaskMetadata="TaskMetadata" Task="Task" Message="message" IsThumbnail="false" IsSelectable="true" IsFullWidth="false" />
                                break;
                        }
                    </Column>
                }
            }
            else
            {
                <Column ColumnSize="ColumnSize.IsFull" TextAlignment="TextAlignment.Center" Margin="Margin.Is3.FromTop.Is3.FromBottom">
                    <Heading Size="HeadingSize.Is4" TextWeight="TextWeight.Bold" Class="text-custom-primary">
                        @(resourceHandler.GetResource($"{UIConstants.Data}.{UIConstants.Error}.{HttpStatusCode.NotFound}.{nameof(TaskMessageDto)}.{UIElementConstants.Collection}"))
                    </Heading>
                </Column>
            }
        </Row>
    </Column>
</Row>

@code {
    [Parameter]
    public TaskDto Task { get; set; } = new();

    [Parameter]
    public TaskViewMetadataDto TaskMetadata { get; set; } = new();
}